<section xml:id="vectors_insertion-removal"
         xmlns:xi="http://www.w3.org/2001/XInclude">

  <title>Erasing and Inserting Elements</title>

  <p>If we do want to remove an element at a location other than the end, there is an <pf>erase</pf> member function.
  You might expect that it takes an index as its parameter, like <pf>vec.erase(2)</pf>. Instead, it requires an <term>iterator</term> be passed as the parameter.</p>
  
  <p>What are iterators? Iterators are objects that store (and manipulate) a location in a collection of data. For now, all we need to know about iterators is that they represent a position in a vector.</p>
  
  <p>To make an iterator that points to index <pf>X</pf> of a vector named <pf>vectorName</pf>, you can specify <pf>vectorName.begin() + X</pf>. <pf>.begin()</pf> makes an iterator that points to the first element of the vector. If you want to point at index 0, you can just say <pf>vectorName.begin()</pf>. When you add <pf>+ X</pf>, it moves the iterator forward by <pf>X</pf> positions.</p>

  <p>For example:</p>

  <program>
<xi:include href="../../programs/vectors/insertion-removal-1.cpp" parse="text"/>
</program>

  <p>It is also possible to specify is also a <pf>.end()</pf> function that makes an iterator that points to one location PAST the end of the vector. (This sounds odd, but ends up being useful as an indicator that we have gone too far and moved past the last element.) Starting from the <pf>.end()</pf> we can do <pf>- X</pf> to move backwards by <pf>X</pf> positions. This means that the last element can be pointed at using <pf>.end() - 1</pf>.</p>
  
  <figure>
    <caption>A vector and some iterators. Note that <pf>.end()</pf> points one past the last element. The last element is at <pf>.end() - 1</pf>.</caption>
    <image width="60%"
           source="images/vectors-iterators.svg"/>
  </figure>
  
  <program>
<xi:include href="../../programs/vectors/insertion-removal-2.cpp" parse="text"/>
</program>


  <p>It is possible to remove a whole range of elements by specifying a start and end location. All the items from start, up to but not including the end location, will be removed. This means that to specify removing up to and including the last element, we want to pass in the location that is AFTER the last element. In a vector with 3 items, the last element is at index 2. So we would use <pf>vectorName.begin() + 3</pf> to specify <q>until the end of the vector</q>. Fortunately, rather than do this, we can also just say <pf>vectorName.end()</pf>:</p>

  <program>
<xi:include href="../../programs/vectors/insertion-removal-3.cpp" parse="text"/>
</program>

  <p>To clear out all the elements in a vector, we can either say to erase from the beginning to the end, or use the <pf>.clear()</pf> method of the vector:</p>

  <program>
<xi:include href="../../programs/vectors/insertion-removal-clear.cpp" parse="text"/>
</program>

  <p>The <pf>.insert(iterator, value)</pf> function works by the same logic to specify where you wish to insert a value. Whatever value is currently at that location and anything after it are <q>pushed over</q> one location so that the new value can be placed in the specified location. This program uses <pf>insert</pf> to add some items to a vector:</p>

  <listing>
  <program label="vectors_insertion-removal-program-1" interactive="activecode">
<xi:include href="../../programs/vectors/insertion-removal-4.cpp" parse="text"/>
</program>
  </listing>

  <p>Specifying an invalid location for either <pf>.insert()</pf> or <pf>.erase()</pf> will result in the program crashing. There will not be an exception thrown! You can test this out in the sample above by specifying something like <pf>letters.begin() + 100</pf> for one of the locations.</p>

  <warning><p>Be very careful with iterators! If your program crashes with no output, or behaves unexpectedly, it might be due to invalid iterator locations.</p></warning>

  <note>
    <p>We aren't covering every possible variation of <pf>.insert()</pf>. For example, if you want to add all the elements from vec2 to the end of vec1, you can use the <pf>insert</pf> function with a range of iterators:</p>
    <program>vec1.insert(vec1.end(), vec2.begin(), vec2.end());</program>
    <p>To say <q>insert at the end of vec1 all the items from the beginning of vec2 to the end of vec2.</q>. Of course, you could also loop through vec2 and insert each element individually using <pf>vec1.push_back()</pf>.</p>
    <p>While the insert version is more concise, it isn't essential to know. When you want to do something with a vector, think in terms of the basic tools first before looking for a fancy shortcut.</p>
  </note>

    <exercise label="vectors_insertion-removal-ex-1">
    <statement>
      <p>Given this sequence of operations, what would <pf>nums</pf> contain?</p>
      <program><![CDATA[ 
vector<int> nums = {10, 12, 15, 18, 24};
nums.erase(nums.begin() + 2);
      ]]>
      </program>
    </statement>
    <choices randomize="yes">
      <choice correct="yes">
        <statement>
          <pf>10 12 18 24</pf>
        </statement>
      </choice>
      <choice>
        <statement>
          <pf>10 15 18 24</pf>
        </statement>
      </choice>
      <choice>
        <statement>
          <pf>10 15</pf>
        </statement>
      </choice>
      <choice>
        <statement>
          <pf>10 12</pf>
        </statement>
      </choice>
    </choices>
  </exercise>

    <exercise label="vectors_insertion-removal-ex-2">
    <statement>
      <p>Given this sequence of operations, what would <pf>nums</pf> contain?</p>
      <program><![CDATA[ 
vector<int> nums = {10, 12, 15, 18, 24};
nums.insert(nums.begin() + 1, 8);
      ]]>
      </program>
    </statement>
    <choices randomize="yes">
      <choice correct="yes">
        <statement>
          <pf>10 8 12 15 18 24</pf>
        </statement>
      </choice>
      <choice>
        <statement>
          <pf>8 10 12 15 18 24</pf>
        </statement>
      </choice>
      <choice>
        <statement>
          <pf>8 12 15 18 24</pf>
        </statement>
      </choice>
      <choice>
        <statement>
          <pf>10 8 15 18 24</pf>
        </statement>
      </choice>
    </choices>
  </exercise>

    <exercise label="vectors_insertion-removal-ex-3">
    <statement>
      <p>Given this sequence of operations, what would <pf>nums</pf> contain?</p>
      <program><![CDATA[ 
vector<int> nums = {10, 12, 15, 18, 24};
nums.erase(nums.begin() + 1, nums.begin() + 3);
      ]]>
      </program>
    </statement>
    <choices randomize="yes">
      <choice correct="yes">
        <statement>
          <pf>10 18 24</pf>
        </statement>
      </choice>
      <choice>
        <statement>
          <pf>10 24</pf>
        </statement>
      </choice>
      <choice>
        <statement>
          <pf>18 24</pf>
        </statement>
      </choice>
      <choice>
        <statement>
          <pf>15 18 24</pf>
        </statement>
      </choice>
    </choices>
  </exercise>

</section>